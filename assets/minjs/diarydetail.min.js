function Diarydetail(){return this instanceof Diarydetail?void this.init():new Diarydetail}Diarydetail.prototype={diaryId:$.getUrlPara("diaryId"),diaryObj:{},init:function(){this.fetchDiary(),this.initDOMs(),this.listenEscPress(),this.editClickEvent(),this.saveClickEvent()},initDOMs:function(){$title=$("input"),$content=$("textarea"),$saveTip=$(".saved-tip")},fetchDiary:function(){var t=this;$.hkAjax("get","/diaries/getdiary",{diaryId:t.diaryId},function(i){t.diaryObj.diaryId=i.diaryId,t.diaryObj.title=i.title,t.diaryObj.content=i.content,t.renderText(i)})},renderText:function(t){console.log(t),$title.val(t.title),$content.val(t.content),this.listenTypeEvent(),this.setTabEvent()},listenTypeEvent:function(){var t=this;$title.donetyping(function(){t.diaryObj.title=$(this).val(),$(this)[0].hasAttribute("readonly")||t.updateDiary(t.diaryObj)},500),$content.donetyping(function(){t.diaryObj.content=$(this).val(),$(this)[0].hasAttribute("readonly")||t.updateDiary(t.diaryObj)},500)},updateDiary:function(t){var i=this;$.hkAjax("post","/diaries/updatediary",{diaryId:t.diaryId,title:t.title,content:t.content},function(t){i.fetchDiary(),$saveTip.slideDown(),setTimeout(function(){$saveTip.slideUp()},800)},"text")},editClickEvent:function(){$(".edit").click(function(){$title.removeAttr("readonly"),$content.removeAttr("readonly")})},saveClickEvent:function(){var t=this;$(".save").click(function(){$title.attr("readonly",!0),$content.attr("readonly",!0),t.updateDiary(t.diaryObj)})},setTabEvent:function(){$content.keydown(function(t){if(9===t.keyCode){var i=this.selectionStart,e=this.selectionEnd;console.log(i,e);var n=$(this),a=n.val();n.val(a.substring(0,i)+"\t"+a.substring(e)),this.selectionStart=this.selectionEnd=i+1,t.preventDefault()}})},listenEscPress:function(){$(document).keyup(function(t){27==t.keyCode&&(window.location.href="/index.html")})}},Object.defineProperty(Diarydetail.prototype,"constructor",{enumerable:!1,value:Diarydetail}),$(function(){new Diarydetail});